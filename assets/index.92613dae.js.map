{"version":3,"file":"index.92613dae.js","sources":["../../node_modules/@codesandbox/nodebox/build/index.mjs","../../node_modules/@codesandbox/sandpack-client/dist/clients/node/index.mjs"],"sourcesContent":["var __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __commonJS = (cb, mod) => function __require() {\n  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(\n  isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", { value: mod, enumerable: true }) : target,\n  mod\n));\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nvar __accessCheck = (obj, member, msg) => {\n  if (!member.has(obj))\n    throw TypeError(\"Cannot \" + msg);\n};\nvar __privateGet = (obj, member, getter) => {\n  __accessCheck(obj, member, \"read from private field\");\n  return getter ? getter.call(obj) : member.get(obj);\n};\nvar __privateAdd = (obj, member, value) => {\n  if (member.has(obj))\n    throw TypeError(\"Cannot add the same private member more than once\");\n  member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\n};\nvar __privateSet = (obj, member, value, setter) => {\n  __accessCheck(obj, member, \"write to private field\");\n  setter ? setter.call(obj, value) : member.set(obj, value);\n  return value;\n};\nvar __privateMethod = (obj, member, method) => {\n  __accessCheck(obj, member, \"access private method\");\n  return method;\n};\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/pad.js\nvar require_pad = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/pad.js\"(exports, module) {\n    module.exports = function pad(num, size) {\n      var s = \"000000000\" + num;\n      return s.substr(s.length - size);\n    };\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/fingerprint.browser.js\nvar require_fingerprint_browser = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/fingerprint.browser.js\"(exports, module) {\n    var pad = require_pad();\n    var env = typeof window === \"object\" ? window : self;\n    var globalCount = Object.keys(env).length;\n    var mimeTypesLength = navigator.mimeTypes ? navigator.mimeTypes.length : 0;\n    var clientId = pad((mimeTypesLength + navigator.userAgent.length).toString(36) + globalCount.toString(36), 4);\n    module.exports = function fingerprint() {\n      return clientId;\n    };\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/getRandomValue.browser.js\nvar require_getRandomValue_browser = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/getRandomValue.browser.js\"(exports, module) {\n    var getRandomValue;\n    var crypto = typeof window !== \"undefined\" && (window.crypto || window.msCrypto) || typeof self !== \"undefined\" && self.crypto;\n    if (crypto) {\n      lim = Math.pow(2, 32) - 1;\n      getRandomValue = function() {\n        return Math.abs(crypto.getRandomValues(new Uint32Array(1))[0] / lim);\n      };\n    } else {\n      getRandomValue = Math.random;\n    }\n    var lim;\n    module.exports = getRandomValue;\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/index.js\nvar require_cuid = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/index.js\"(exports, module) {\n    var fingerprint = require_fingerprint_browser();\n    var pad = require_pad();\n    var getRandomValue = require_getRandomValue_browser();\n    var c = 0;\n    var blockSize = 4;\n    var base = 36;\n    var discreteValues = Math.pow(base, blockSize);\n    function randomBlock() {\n      return pad((getRandomValue() * discreteValues << 0).toString(base), blockSize);\n    }\n    function safeCounter() {\n      c = c < discreteValues ? c : 0;\n      c++;\n      return c - 1;\n    }\n    function cuid3() {\n      var letter = \"c\", timestamp = new Date().getTime().toString(base), counter = pad(safeCounter().toString(base), blockSize), print = fingerprint(), random = randomBlock() + randomBlock();\n      return letter + timestamp + counter + print + random;\n    }\n    cuid3.slug = function slug() {\n      var date = new Date().getTime().toString(36), counter = safeCounter().toString(36).slice(-4), print = fingerprint().slice(0, 1) + fingerprint().slice(-1), random = randomBlock().slice(-2);\n      return date.slice(-2) + counter + print + random;\n    };\n    cuid3.isCuid = function isCuid(stringToCheck) {\n      if (typeof stringToCheck !== \"string\")\n        return false;\n      if (stringToCheck.startsWith(\"c\"))\n        return true;\n      return false;\n    };\n    cuid3.isSlug = function isSlug(stringToCheck) {\n      if (typeof stringToCheck !== \"string\")\n        return false;\n      var stringLength = stringToCheck.length;\n      if (stringLength >= 7 && stringLength <= 10)\n        return true;\n      return false;\n    };\n    cuid3.fingerprint = fingerprint;\n    module.exports = cuid3;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/createDeferredExecutor.js\nvar require_createDeferredExecutor = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/createDeferredExecutor.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.createDeferredExecutor = void 0;\n    function createDeferredExecutor() {\n      const executor = (resolve, reject) => {\n        executor.state = \"pending\";\n        executor.resolve = (data) => {\n          if (executor.state !== \"pending\") {\n            return;\n          }\n          executor.result = data;\n          const onFulfilled = (value) => {\n            executor.state = \"fulfilled\";\n            return value;\n          };\n          return resolve(data instanceof Promise ? data : Promise.resolve(data).then(onFulfilled));\n        };\n        executor.reject = (reason) => {\n          if (executor.state !== \"pending\") {\n            return;\n          }\n          queueMicrotask(() => {\n            executor.state = \"rejected\";\n          });\n          return reject(executor.rejectionReason = reason);\n        };\n      };\n      return executor;\n    }\n    exports.createDeferredExecutor = createDeferredExecutor;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/DeferredPromise.js\nvar require_DeferredPromise = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/DeferredPromise.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.DeferredPromise = void 0;\n    var createDeferredExecutor_1 = require_createDeferredExecutor();\n    var DeferredPromise4 = class extends Promise {\n      #executor;\n      resolve;\n      reject;\n      constructor(executor = null) {\n        const deferredExecutor = (0, createDeferredExecutor_1.createDeferredExecutor)();\n        super((originalResolve, originalReject) => {\n          deferredExecutor(originalResolve, originalReject);\n          executor?.(deferredExecutor.resolve, deferredExecutor.reject);\n        });\n        this.#executor = deferredExecutor;\n        this.resolve = this.#executor.resolve;\n        this.reject = this.#executor.reject;\n      }\n      get state() {\n        return this.#executor.state;\n      }\n      get rejectionReason() {\n        return this.#executor.rejectionReason;\n      }\n      then(onFulfilled, onRejected) {\n        return this.#decorate(super.then(onFulfilled, onRejected));\n      }\n      catch(onRejected) {\n        return this.#decorate(super.catch(onRejected));\n      }\n      finally(onfinally) {\n        return this.#decorate(super.finally(onfinally));\n      }\n      #decorate(promise) {\n        return Object.defineProperties(promise, {\n          resolve: { configurable: true, value: this.resolve },\n          reject: { configurable: true, value: this.reject }\n        });\n      }\n    };\n    exports.DeferredPromise = DeferredPromise4;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/index.js\nvar require_build = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/index.js\"(exports) {\n    \"use strict\";\n    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      var desc = Object.getOwnPropertyDescriptor(m, k);\n      if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n        desc = { enumerable: true, get: function() {\n          return m[k];\n        } };\n      }\n      Object.defineProperty(o, k2, desc);\n    } : function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      o[k2] = m[k];\n    });\n    var __exportStar = exports && exports.__exportStar || function(m, exports2) {\n      for (var p in m)\n        if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports2, p))\n          __createBinding(exports2, m, p);\n    };\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    __exportStar(require_createDeferredExecutor(), exports);\n    __exportStar(require_DeferredPromise(), exports);\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/MemoryLeakError.js\nvar require_MemoryLeakError = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/MemoryLeakError.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.MemoryLeakError = void 0;\n    var MemoryLeakError = class extends Error {\n      emitter;\n      type;\n      count;\n      constructor(emitter, type, count) {\n        super(`Possible EventEmitter memory leak detected. ${count} ${type.toString()} listeners added. Use emitter.setMaxListeners() to increase limit`);\n        this.emitter = emitter;\n        this.type = type;\n        this.count = count;\n        this.name = \"MaxListenersExceededWarning\";\n      }\n    };\n    exports.MemoryLeakError = MemoryLeakError;\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/Emitter.js\nvar require_Emitter = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/Emitter.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.Emitter = void 0;\n    var MemoryLeakError_1 = require_MemoryLeakError();\n    var _events, _maxListeners, _hasWarnedAboutPotentialMemortyLeak, _getListeners, getListeners_fn, _removeListener, removeListener_fn, _wrapOnceListener, wrapOnceListener_fn, _internalEmit, internalEmit_fn;\n    var _Emitter = class {\n      constructor() {\n        __privateAdd(this, _getListeners);\n        __privateAdd(this, _removeListener);\n        __privateAdd(this, _wrapOnceListener);\n        __privateAdd(this, _internalEmit);\n        __privateAdd(this, _events, void 0);\n        __privateAdd(this, _maxListeners, void 0);\n        __privateAdd(this, _hasWarnedAboutPotentialMemortyLeak, void 0);\n        __privateSet(this, _events, /* @__PURE__ */ new Map());\n        __privateSet(this, _maxListeners, _Emitter.defaultMaxListeners);\n        __privateSet(this, _hasWarnedAboutPotentialMemortyLeak, false);\n      }\n      static listenerCount(emitter, eventName) {\n        return emitter.listenerCount(eventName);\n      }\n      setMaxListeners(maxListeners) {\n        __privateSet(this, _maxListeners, maxListeners);\n        return this;\n      }\n      getMaxListeners() {\n        return __privateGet(this, _maxListeners);\n      }\n      eventNames() {\n        return Array.from(__privateGet(this, _events).keys());\n      }\n      emit(eventName, ...data) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        listeners.forEach((listener) => {\n          listener.apply(this, data);\n        });\n        return listeners.length > 0;\n      }\n      addListener(eventName, listener) {\n        __privateMethod(this, _internalEmit, internalEmit_fn).call(this, \"newListener\", eventName, listener);\n        const nextListeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName).concat(listener);\n        __privateGet(this, _events).set(eventName, nextListeners);\n        if (__privateGet(this, _maxListeners) > 0 && this.listenerCount(eventName) > __privateGet(this, _maxListeners) && !__privateGet(this, _hasWarnedAboutPotentialMemortyLeak)) {\n          __privateSet(this, _hasWarnedAboutPotentialMemortyLeak, true);\n          const memoryLeakWarning = new MemoryLeakError_1.MemoryLeakError(this, eventName, this.listenerCount(eventName));\n          console.warn(memoryLeakWarning);\n        }\n        return this;\n      }\n      on(eventName, listener) {\n        return this.addListener(eventName, listener);\n      }\n      once(eventName, listener) {\n        return this.addListener(eventName, __privateMethod(this, _wrapOnceListener, wrapOnceListener_fn).call(this, eventName, listener));\n      }\n      prependListener(eventName, listener) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        if (listeners.length > 0) {\n          const nextListeners = [listener].concat(listeners);\n          __privateGet(this, _events).set(eventName, nextListeners);\n        } else {\n          __privateGet(this, _events).set(eventName, listeners.concat(listener));\n        }\n        return this;\n      }\n      prependOnceListener(eventName, listener) {\n        return this.prependListener(eventName, __privateMethod(this, _wrapOnceListener, wrapOnceListener_fn).call(this, eventName, listener));\n      }\n      removeListener(eventName, listener) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        if (listeners.length > 0) {\n          __privateMethod(this, _removeListener, removeListener_fn).call(this, listeners, listener);\n          __privateGet(this, _events).set(eventName, listeners);\n          __privateMethod(this, _internalEmit, internalEmit_fn).call(this, \"removeListener\", eventName, listener);\n        }\n        return this;\n      }\n      off(eventName, listener) {\n        return this.removeListener(eventName, listener);\n      }\n      removeAllListeners(eventName) {\n        if (eventName) {\n          __privateGet(this, _events).delete(eventName);\n        } else {\n          __privateGet(this, _events).clear();\n        }\n        return this;\n      }\n      listeners(eventName) {\n        return Array.from(__privateMethod(this, _getListeners, getListeners_fn).call(this, eventName));\n      }\n      listenerCount(eventName) {\n        return __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName).length;\n      }\n      rawListeners(eventName) {\n        return this.listeners(eventName);\n      }\n    };\n    var Emitter2 = _Emitter;\n    _events = new WeakMap();\n    _maxListeners = new WeakMap();\n    _hasWarnedAboutPotentialMemortyLeak = new WeakMap();\n    _getListeners = new WeakSet();\n    getListeners_fn = function(eventName) {\n      return __privateGet(this, _events).get(eventName) || [];\n    };\n    _removeListener = new WeakSet();\n    removeListener_fn = function(listeners, listener) {\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n      return [];\n    };\n    _wrapOnceListener = new WeakSet();\n    wrapOnceListener_fn = function(eventName, listener) {\n      const onceListener = (...data) => {\n        this.removeListener(eventName, onceListener);\n        listener.apply(this, data);\n      };\n      return onceListener;\n    };\n    _internalEmit = new WeakSet();\n    internalEmit_fn = function(internalEventName, eventName, listener) {\n      this.emit(\n        internalEventName,\n        ...[eventName, listener]\n      );\n    };\n    __publicField(Emitter2, \"defaultMaxListeners\", 10);\n    exports.Emitter = Emitter2;\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/index.js\nvar require_lib = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/index.js\"(exports) {\n    \"use strict\";\n    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      var desc = Object.getOwnPropertyDescriptor(m, k);\n      if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n        desc = { enumerable: true, get: function() {\n          return m[k];\n        } };\n      }\n      Object.defineProperty(o, k2, desc);\n    } : function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      o[k2] = m[k];\n    });\n    var __exportStar = exports && exports.__exportStar || function(m, exports2) {\n      for (var p in m)\n        if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports2, p))\n          __createBinding(exports2, m, p);\n    };\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    __exportStar(require_Emitter(), exports);\n    __exportStar(require_MemoryLeakError(), exports);\n  }\n});\n\n// src/messages.ts\nvar import_cuid = __toESM(require_cuid());\n\n// ../../node_modules/.pnpm/outvariant@1.4.0/node_modules/outvariant/lib/index.mjs\nvar POSITIONALS_EXP = /(%?)(%([sdjo]))/g;\nfunction serializePositional(positional, flag) {\n  switch (flag) {\n    case \"s\":\n      return positional;\n    case \"d\":\n    case \"i\":\n      return Number(positional);\n    case \"j\":\n      return JSON.stringify(positional);\n    case \"o\": {\n      if (typeof positional === \"string\") {\n        return positional;\n      }\n      const json = JSON.stringify(positional);\n      if (json === \"{}\" || json === \"[]\" || /^\\[object .+?\\]$/.test(json)) {\n        return positional;\n      }\n      return json;\n    }\n  }\n}\nfunction format(message, ...positionals) {\n  if (positionals.length === 0) {\n    return message;\n  }\n  let positionalIndex = 0;\n  let formattedMessage = message.replace(\n    POSITIONALS_EXP,\n    (match, isEscaped, _, flag) => {\n      const positional = positionals[positionalIndex];\n      const value = serializePositional(positional, flag);\n      if (!isEscaped) {\n        positionalIndex++;\n        return value;\n      }\n      return match;\n    }\n  );\n  if (positionalIndex < positionals.length) {\n    formattedMessage += ` ${positionals.slice(positionalIndex).join(\" \")}`;\n  }\n  formattedMessage = formattedMessage.replace(/%{2,2}/g, \"%\");\n  return formattedMessage;\n}\nvar STACK_FRAMES_TO_IGNORE = 2;\nfunction cleanErrorStack(error) {\n  if (!error.stack) {\n    return;\n  }\n  const nextStack = error.stack.split(\"\\n\");\n  nextStack.splice(1, STACK_FRAMES_TO_IGNORE);\n  error.stack = nextStack.join(\"\\n\");\n}\nvar InvariantError = class extends Error {\n  constructor(message, ...positionals) {\n    super(message);\n    this.message = message;\n    this.name = \"Invariant Violation\";\n    this.message = format(message, ...positionals);\n    cleanErrorStack(this);\n  }\n};\nvar invariant = (predicate, message, ...positionals) => {\n  if (!predicate) {\n    throw new InvariantError(message, ...positionals);\n  }\n};\ninvariant.as = (ErrorConstructor, predicate, message, ...positionals) => {\n  if (!predicate) {\n    const isConstructor = ErrorConstructor.prototype.name != null;\n    const error = isConstructor ? new ErrorConstructor(format(message, positionals)) : ErrorConstructor(format(message, positionals));\n    throw error;\n  }\n};\n\n// src/messages.ts\nvar import_deferred_promise = __toESM(require_build());\n\n// src/logger.ts\nvar FLAG = window.localStorage[\"CSB_EMULATOR_DEBUG\"];\nvar DEFAULT = \"\\x1B[0m\";\nvar GREEN = \"\\x1B[32;1m\";\nvar RED = \"\\x1B[31m\";\nvar BLUE = \"\\x1B[34m\";\nvar YELLOW = \"\\x1B[33;1m\";\nvar MAGENTA = \"\\x1B[35;1m\";\nvar CYAN = \"\\x1B[36;1m\";\nvar COLOR_SCOPE = {\n  preview: YELLOW,\n  emulator: MAGENTA,\n  runtime: CYAN,\n  bridge: BLUE,\n  \"runtime:worker\": CYAN\n};\nfunction createDebug(scope) {\n  return function debug3(message, ...data) {\n    if (FLAG === \"true\") {\n      const direction = () => {\n        if (message.includes(\"sender\"))\n          return `${GREEN}sender`;\n        if (message.includes(\"receiver\"))\n          return `${RED}receiver`;\n        return \"\";\n      };\n      const cleanMessage = message.replace(/\\[.+\\]:/, \"\");\n      console.debug(`${COLOR_SCOPE[scope]}${scope}:${direction()}${DEFAULT}:${cleanMessage}`, ...data);\n    }\n  };\n}\n\n// src/messages.ts\nvar debug = createDebug(\"emulator\");\nvar MessageReceiver = class {\n  emitter;\n  senderPort = null;\n  constructor() {\n    this.emitter = new EventTarget();\n    this.waitForHandshake();\n  }\n  waitForHandshake() {\n    const handshakePromise = new import_deferred_promise.DeferredPromise();\n    const handshakeListener = (message) => {\n      const { data } = message;\n      debug(\"[message-receiver]: incoming\", message);\n      if (data.type === \"internal/handshake\") {\n        invariant(\n          message.ports.length > 0,\n          \"Failed to confirm a MessageReceiver handshake: received event has no ports\"\n        );\n        this.senderPort = message.ports[0];\n        this.addMessageListener();\n        debug(\"[message-receiver]: handshake received!\", this.senderPort);\n        this.send(\"internal/handshake/done\");\n        debug(\"[message-receiver]: finish handshake\");\n      }\n    };\n    window.addEventListener(\"message\", handshakeListener);\n    handshakePromise.then(() => {\n      window.removeEventListener(\"message\", handshakeListener);\n    });\n    window.parent.postMessage({ type: \"internal/ready\" }, \"*\");\n    return handshakePromise;\n  }\n  addMessageListener() {\n    invariant(\n      this.senderPort,\n      \"[MessageReceiver] Failed to add a message listener: sender port is not defined. Did you forget to await a handshake?\"\n    );\n    this.senderPort.onmessage = (evt) => {\n      const data = evt.data;\n      if (data.type == null) {\n        return;\n      }\n      this.emitter.dispatchEvent(\n        new MessageEvent(data.type, {\n          data: data.payload\n        })\n      );\n    };\n  }\n  on(event, listener, options) {\n    this.emitter.addEventListener(\n      event,\n      async (message) => {\n        if (!(message instanceof MessageEvent)) {\n          return;\n        }\n        const { operationId, payload } = message.data;\n        try {\n          const listenerPayload = await listener(payload);\n          this.send(\"internal/operation/done\", { operationId, listenerPayload });\n        } catch (error) {\n          if (error instanceof Error) {\n            this.send(\"internal/operation/failed\", { operationId, error });\n          }\n        }\n      },\n      options\n    );\n  }\n  send(event, ...data) {\n    invariant(\n      this.senderPort,\n      '[MessageReceiver] Failed to send a message \"%j\": sender port is not defined. Did you forget to await a handshake?',\n      event\n    );\n    const payload = data[0] || {};\n    debug('[message-receiver]: send \"%s\"', event, payload);\n    this.senderPort.postMessage({ type: event, payload });\n  }\n};\nvar MessageSender = class {\n  constructor(target) {\n    this.target = target;\n    this.emitter = new EventTarget();\n    this.channel = new MessageChannel();\n    this.receiverPort = this.channel.port1;\n    const receiverReadyPromise = new import_deferred_promise.DeferredPromise();\n    const handshakeListener = (message) => {\n      if (message.data.type === \"internal/ready\") {\n        debug(\"[message-sender]: runtime is ready\");\n        receiverReadyPromise.resolve();\n      }\n    };\n    window.addEventListener(\"message\", handshakeListener);\n    receiverReadyPromise.then(() => {\n      window.removeEventListener(\"message\", handshakeListener);\n    });\n    this.receiverReadyPromise = receiverReadyPromise;\n    this.receiverPort.onmessage = (evt) => {\n      const data = evt.data;\n      if (data.type != null) {\n        debug('[message-sender]: emitting \"%s\" event...', data.type, data.payload);\n        this.emitter.dispatchEvent(new MessageEvent(data.type, { data: data.payload }));\n      }\n    };\n  }\n  emitter;\n  channel;\n  receiverPort;\n  receiverReadyPromise;\n  async handshake() {\n    const handshakePromise = new import_deferred_promise.DeferredPromise();\n    await this.receiverReadyPromise;\n    debug(\"[message-sender]: sending handshake\");\n    this.target.postMessage(\n      {\n        type: \"internal/handshake\"\n      },\n      \"*\",\n      [this.channel.port2]\n    );\n    this.on(\"internal/handshake/done\", () => {\n      handshakePromise.resolve();\n      clearTimeout(rejectionTimeout);\n    });\n    const rejectionTimeout = setTimeout(() => {\n      handshakePromise.reject(new Error(\"MessageSender: Handshake timeout\"));\n    }, 5e3);\n    return handshakePromise;\n  }\n  on(event, listener, options) {\n    debug('[message-sender]: add listener \"%s\"', event);\n    this.emitter.addEventListener(\n      event,\n      (message) => {\n        if (message instanceof MessageEvent) {\n          listener(message);\n        }\n      },\n      options\n    );\n  }\n  off(event, listener, options) {\n    this.emitter.removeEventListener(event, listener, options);\n  }\n  async send(event, ...data) {\n    const operationPromise = new import_deferred_promise.DeferredPromise();\n    const operationId = (0, import_cuid.default)();\n    const payload = data[0] || {};\n    debug('[message-sender]: send \"%s\" (%s)', event, operationId, payload);\n    this.receiverPort.postMessage({ type: event, payload: { operationId, payload } });\n    debug('[message-sender]: adding done listener for \"%s\" (%s)', event, operationId);\n    const handleOperationDone = (doneEvent) => {\n      const { data: data2 } = doneEvent;\n      if (data2.operationId === operationId) {\n        const listenerPayload = data2.listenerPayload || {};\n        debug('[message-sender]: resolving \"%s (%s) promise!', event, operationId);\n        operationPromise.resolve({\n          ...listenerPayload,\n          operationId: data2.operationId\n        });\n      }\n    };\n    const handleOperationFailed = (failEvent) => {\n      const { data: data2 } = failEvent;\n      if (data2.operationId === operationId) {\n        debug('[message-sender]: rejecting \"%s (%s) promise!', event, operationId);\n        operationPromise.reject(data2.error);\n      }\n    };\n    this.on(\"internal/operation/done\", handleOperationDone);\n    this.on(\"internal/operation/failed\", handleOperationFailed);\n    return operationPromise.finally(() => {\n      this.emitter.removeEventListener(\"internal/operation/done\", handleOperationDone);\n      this.emitter.removeEventListener(\"internal/operation/failed\", handleOperationFailed);\n    });\n  }\n};\n\n// src/Nodebox.ts\nvar import_deferred_promise3 = __toESM(require_build());\n\n// src/modules/fs.ts\nvar import_cuid2 = __toESM(require_cuid());\nvar FileSystemApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  async init(files) {\n    await this.channel.send(\"fs/init\", { files });\n  }\n  async readFile(path, encoding) {\n    const response = await this.channel.send(\"fs/readFile\", { path, encoding }).catch((error) => {\n      throw new Error(format('Failed to read file at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"File not found\");\n    }\n    return response.data;\n  }\n  async writeFile(path, content, options) {\n    let encoding = void 0;\n    let recursive = false;\n    if (typeof options === \"object\") {\n      encoding = options.encoding;\n      recursive = !!options.recursive;\n    } else if (typeof options === \"string\") {\n      encoding = options;\n    }\n    await this.channel.send(\"fs/writeFile\", { path, content, encoding, recursive }).catch((error) => {\n      throw new Error(format('Failed to write file at path \"%s\"', path), { cause: error });\n    });\n  }\n  async readdir(path) {\n    const response = await this.channel.send(\"fs/readdir\", { path }).catch((error) => {\n      throw new Error(format('Failed to read directory at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"Directory not found\");\n    }\n    return response.data;\n  }\n  async mkdir(path, options) {\n    const recursive = !!options?.recursive;\n    await this.channel.send(\"fs/mkdir\", { path, recursive }).catch((error) => {\n      throw new Error(format('Failed to make directory at path \"%s\"', path), { cause: error });\n    });\n  }\n  async stat(path) {\n    const response = await this.channel.send(\"fs/stat\", { path }).catch((error) => {\n      throw new Error(format('Failed to stat file at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"File not found\");\n    }\n    return response.data;\n  }\n  async rm(path, options) {\n    const { force, recursive } = options || {};\n    await this.channel.send(\"fs/rm\", { path, force, recursive }).catch((error) => {\n      throw new Error(format('Failed to remove file at path \"%s\"', path), { cause: error });\n    });\n  }\n  async watch(includes, excludes, listener) {\n    const watcherId = (0, import_cuid2.default)();\n    await this.channel.send(\"fs/watch\", { watcherId, includes, excludes });\n    this.channel.on(\"fs/watch-event\", ({ data }) => {\n      if (data.watcherId === watcherId && listener) {\n        const evt = { ...data };\n        delete evt.watcherId;\n        listener(evt);\n      }\n    });\n    return {\n      dispose: () => this.channel.send(\"fs/unwatch\", { watcherId })\n    };\n  }\n};\n\n// src/modules/shell.ts\nvar import_strict_event_emitter = __toESM(require_lib());\nvar ShellApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  create() {\n    return new ShellProcess(this.channel);\n  }\n};\nvar ShellProcess = class {\n  constructor(channel) {\n    this.channel = channel;\n    this.state = \"running\";\n    this.stdout = new import_strict_event_emitter.Emitter();\n    this.stderr = new import_strict_event_emitter.Emitter();\n    this.stdin = {\n      write: (data) => {\n        if (!this.id) {\n          throw new Error(\"Failed to write to stdin, no process is currently running\");\n        }\n        return this.channel.send(\"shell/stdin\", { data, workerId: this.id });\n      }\n    };\n    this.forwardStdEvents();\n  }\n  id;\n  state;\n  stdout;\n  stderr;\n  stdin;\n  forwardStdEvents() {\n    this.channel.on(\"worker/tty\", (message) => {\n      const { data } = message;\n      if (data.workerId !== this.id) {\n        return;\n      }\n      switch (data.payload.type) {\n        case \"out\": {\n          this.stdout.emit(\"data\", data.payload.data);\n          break;\n        }\n        case \"err\": {\n          this.stderr.emit(\"data\", data.payload.data);\n          break;\n        }\n      }\n    });\n  }\n  async runCommand(command, args, options = {}) {\n    invariant(!this.id, 'Failed to run \"runCommand\" on a ShellProcess: there is already a process running.');\n    const shellInfo = await this.channel.send(\"shell/runCommand\", { command, args, options });\n    invariant(shellInfo, 'Failed to run \"runCommand\" on a ShellProcess: was not able to retrieve a running process.');\n    this.id = shellInfo.id;\n    this.state = \"running\";\n    return shellInfo;\n  }\n  async on(message, listener) {\n    switch (message) {\n      case \"progress\": {\n        this.channel.on(\"worker/progress\", ({ data }) => {\n          listener(data.status);\n        });\n        return;\n      }\n      case \"exit\": {\n        this.channel.on(\"worker/exit\", ({ data }) => {\n          if (data.workerId === this.id) {\n            listener(data.exitCode, data.error);\n          }\n        });\n        return;\n      }\n    }\n  }\n  async kill() {\n    invariant(\n      this.id,\n      'Failed to run \"kill\" on a ShellProcess: there is no process running. Did you forget to run it?'\n    );\n    this.state = \"idle\";\n    await this.channel.send(\"shell/exit\", { id: this.id }).catch((error) => {\n      throw new Error(format('Failed to kill shell with ID \"%s\"', this.id), { cause: error });\n    });\n    this.id = void 0;\n  }\n};\n\n// src/modules/preview.ts\nvar import_deferred_promise2 = __toESM(require_build());\nvar TIMEOUT = 2e4;\nvar PreviewApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  async waitFor(payload, predicate, timeout = TIMEOUT) {\n    const readyPromise = new import_deferred_promise2.DeferredPromise();\n    const rejectTimeout = setTimeout(() => {\n      readyPromise.reject();\n    }, timeout);\n    const previewInformation = await this.channel.send(\"preview/get/info\", payload).catch((error) => {\n      readyPromise.reject(\n        new Error(\n          format(\n            'Failed to look up preview information for shell ID \"%s\" (port: %d)',\n            payload.sourceShellId,\n            payload.port\n          )\n        )\n      );\n    });\n    const foundPreview = previewInformation && predicate(previewInformation);\n    if (foundPreview) {\n      readyPromise.resolve({\n        url: previewInformation.url,\n        port: previewInformation.port,\n        sourceShellId: previewInformation.sourceShellId\n      });\n    }\n    this.channel.on(\"preview/port/ready\", ({ data }) => {\n      if (!foundPreview && predicate(data)) {\n        readyPromise.resolve({\n          url: data.url,\n          port: data.port,\n          sourceShellId: data.sourceShellId\n        });\n      }\n    });\n    return readyPromise.finally(() => {\n      clearTimeout(rejectTimeout);\n    });\n  }\n  async getByShellId(sourceShellId, timeout) {\n    return this.waitFor({ sourceShellId }, (data) => data.sourceShellId === sourceShellId, timeout).catch((error) => {\n      throw new Error(format('Failed to get shell by ID \"%s\"', sourceShellId), { cause: error });\n    });\n  }\n  async waitForPort(port, timeout) {\n    return this.waitFor({ port }, (data) => data.port === port, timeout).catch((error) => {\n      throw new Error(format(\"Failed to await port %d\", port), { cause: error });\n    });\n  }\n};\n\n// src/Nodebox.ts\nvar DEFAULT_RUNTIME_URL = \"https://nodebox-runtime.codesandbox.io\";\nvar debug2 = createDebug(\"emulator\");\nvar Nodebox = class {\n  constructor(options) {\n    this.options = options;\n    invariant(\n      this.options.iframe,\n      'Failed to create a Nodebox: expected \"iframe\" argument to be a reference to an <iframe> element but got %j',\n      this.options.iframe\n    );\n    this.url = this.options.runtimeUrl || DEFAULT_RUNTIME_URL;\n    this.isConnected = false;\n  }\n  channel = null;\n  isConnected;\n  url;\n  fileSystemApi = null;\n  shellApi = null;\n  previewApi = null;\n  async connect() {\n    const { iframe, cdnUrl } = this.options;\n    debug2(\"[message-sender]: Connecting to node emulator...\");\n    const connectionPromise = new import_deferred_promise3.DeferredPromise();\n    if (!this.url) {\n      connectionPromise.reject(\n        new Error(\"Nodebox URL is missing. Did you forget to provide it when creating this Nodebox instance?\")\n      );\n    }\n    invariant(\n      iframe.contentWindow,\n      \"Failed to create a MessageChannel with the Nodebox iframe: no content window found\"\n    );\n    this.channel = new MessageSender(iframe.contentWindow);\n    const frameLoadPromise = new import_deferred_promise3.DeferredPromise();\n    iframe.setAttribute(\"src\", this.url);\n    iframe.addEventListener(\n      \"load\",\n      () => {\n        frameLoadPromise.resolve();\n      },\n      { once: true }\n    );\n    iframe.addEventListener(\n      \"error\",\n      (event) => {\n        frameLoadPromise.reject(event.error);\n      },\n      { once: true }\n    );\n    await frameLoadPromise;\n    debug2(\"[message-sender]: IFrame loaded...\");\n    await this.channel.handshake();\n    debug2(\"[message-sender]: Handshake completed...\");\n    this.channel.send(\"connect\", {\n      cdnUrl\n    });\n    this.channel.on(\"runtime/ready\", () => {\n      connectionPromise.resolve();\n    });\n    return connectionPromise.then(() => {\n      debug2(\"[message-sender]: Connected to runtime...\");\n      this.isConnected = true;\n    });\n  }\n  get fs() {\n    invariant(\n      this.isConnected,\n      'Failed to access the File System API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.fileSystemApi) {\n      return this.fileSystemApi;\n    }\n    this.fileSystemApi = new FileSystemApi(this.channel);\n    return this.fileSystemApi;\n  }\n  get shell() {\n    invariant(\n      this.isConnected,\n      'Failed to access the Shell API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.shellApi) {\n      return this.shellApi;\n    }\n    this.shellApi = new ShellApi(this.channel);\n    return this.shellApi;\n  }\n  get preview() {\n    invariant(\n      this.isConnected,\n      'Failed to access the Preview API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.previewApi) {\n      return this.previewApi;\n    }\n    this.previewApi = new PreviewApi(this.channel);\n    return this.previewApi;\n  }\n};\n\n// src/runtime-protocol.types.ts\nvar INJECT_MESSAGE_TYPE = \"INJECT_AND_INVOKE\";\nvar PREVIEW_LOADED_MESSAGE_TYPE = \"PREVIEW_LOADED\";\nexport {\n  INJECT_MESSAGE_TYPE,\n  MessageReceiver,\n  MessageSender,\n  Nodebox,\n  PREVIEW_LOADED_MESSAGE_TYPE\n};\n","import { _ as __awaiter, a as __generator, n as nullthrows, c as createError, g as __extends, h as __assign } from '../../types-0877c553.mjs';\nimport { INJECT_MESSAGE_TYPE, Nodebox, PREVIEW_LOADED_MESSAGE_TYPE } from '@codesandbox/nodebox';\nimport { S as SandpackClient } from '../../base-80a1f760.mjs';\nimport { c as consoleHook, f as fromBundlerFilesToFS, r as readBuffer, w as writeBuffer, g as generateRandomId, E as EventEmitter, a as getMessageFromError, b as findStartScriptPackageJson } from '../../consoleHook-cdbe54ab.mjs';\nimport 'outvariant';\nimport 'dequal';\n\nfunction loadPreviewIframe(iframe, url) {\n    return __awaiter(this, void 0, void 0, function () {\n        var contentWindow, TIME_OUT, MAX_MANY_TIRES, tries, timeout;\n        return __generator(this, function (_a) {\n            contentWindow = iframe.contentWindow;\n            nullthrows(contentWindow, \"Failed to await preview iframe: no content window found\");\n            TIME_OUT = 90000;\n            MAX_MANY_TIRES = 20;\n            tries = 0;\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n                    var triesToSetUrl = function () {\n                        var onLoadPage = function () {\n                            clearTimeout(timeout);\n                            tries = MAX_MANY_TIRES;\n                            resolve();\n                            iframe.removeEventListener(\"load\", onLoadPage);\n                        };\n                        if (tries >= MAX_MANY_TIRES) {\n                            reject(createError(\"Could not able to connect to preview.\"));\n                            return;\n                        }\n                        iframe.setAttribute(\"src\", url);\n                        timeout = setTimeout(function () {\n                            triesToSetUrl();\n                            iframe.removeEventListener(\"load\", onLoadPage);\n                        }, TIME_OUT);\n                        tries = tries + 1;\n                        iframe.addEventListener(\"load\", onLoadPage);\n                    };\n                    iframe.addEventListener(\"error\", function () { return reject(new Error(\"Iframe error\")); });\n                    iframe.addEventListener(\"abort\", function () { return reject(new Error(\"Aborted\")); });\n                    triesToSetUrl();\n                })];\n        });\n    });\n}\nvar setPreviewIframeProperties = function (iframe, options) {\n    iframe.style.border = \"0\";\n    iframe.style.width = options.width || \"100%\";\n    iframe.style.height = options.height || \"100%\";\n    iframe.style.overflow = \"hidden\";\n    iframe.allow = \"cross-origin-isolated\";\n};\n\n/* eslint-disable @typescript-eslint/ban-ts-comment, @typescript-eslint/explicit-function-return-type, no-restricted-globals, @typescript-eslint/no-explicit-any  */\nfunction setupHistoryListeners(_a) {\n    var scope = _a.scope;\n    // @ts-ignore\n    var origHistoryProto = window.history.__proto__;\n    var historyList = [];\n    var historyPosition = 0;\n    var dispatchMessage = function (url) {\n        parent.postMessage({\n            type: \"urlchange\",\n            url: url,\n            back: historyPosition > 0,\n            forward: historyPosition < historyList.length - 1,\n            channelId: scope.channelId,\n        }, \"*\");\n    };\n    function pushHistory(url, state) {\n        // remove \"future\" locations\n        historyList.splice(historyPosition + 1);\n        historyList.push({ url: url, state: state });\n        historyPosition = historyList.length - 1;\n    }\n    Object.assign(window.history, {\n        go: function (delta) {\n            var newPos = historyPosition + delta;\n            if (newPos >= 0 && newPos <= historyList.length - 1) {\n                historyPosition = newPos;\n                var _a = historyList[historyPosition], url = _a.url, state = _a.state;\n                origHistoryProto.replaceState.call(window.history, state, \"\", url);\n                var newURL = document.location.href;\n                dispatchMessage(newURL);\n                window.dispatchEvent(new PopStateEvent(\"popstate\", { state: state }));\n            }\n        },\n        back: function () {\n            window.history.go(-1);\n        },\n        forward: function () {\n            window.history.go(1);\n        },\n        pushState: function (state, title, url) {\n            origHistoryProto.replaceState.call(window.history, state, title, url);\n            pushHistory(url, state);\n            dispatchMessage(document.location.href);\n        },\n        replaceState: function (state, title, url) {\n            origHistoryProto.replaceState.call(window.history, state, title, url);\n            historyList[historyPosition] = { state: state, url: url };\n            dispatchMessage(document.location.href);\n        },\n    });\n    function handleMessage(_a) {\n        var data = _a.data;\n        if (data.type === \"urlback\") {\n            history.back();\n        }\n        else if (data.type === \"urlforward\") {\n            history.forward();\n        }\n        else if (data.type === \"refresh\") {\n            document.location.reload();\n        }\n    }\n    window.addEventListener(\"message\", handleMessage);\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction watchResize(_a) {\n    var scope = _a.scope;\n    var lastHeight = 0;\n    function getDocumentHeight() {\n        if (typeof window === \"undefined\")\n            return 0;\n        var body = document.body;\n        var html = document.documentElement;\n        return Math.max(body.scrollHeight, body.offsetHeight, html.offsetHeight);\n    }\n    function sendResizeEvent() {\n        var height = getDocumentHeight();\n        if (lastHeight !== height) {\n            window.parent.postMessage({\n                type: \"resize\",\n                height: height,\n                codesandbox: true,\n                channelId: scope.channelId,\n            }, \"*\");\n        }\n        lastHeight = height;\n    }\n    sendResizeEvent();\n    var throttle;\n    var observer = new MutationObserver(function () {\n        if (throttle === undefined) {\n            sendResizeEvent();\n            throttle = setTimeout(function () {\n                throttle = undefined;\n            }, 300);\n        }\n    });\n    observer.observe(document, {\n        attributes: true,\n        childList: true,\n        subtree: true,\n    });\n    /**\n     * Ideally we should only use a `MutationObserver` to trigger a resize event,\n     * however, we noted that it's not 100% reliable, so we went for polling strategy as well\n     */\n    setInterval(sendResizeEvent, 300);\n}\n\n/* eslint-disable @typescript-eslint/ban-ts-comment */\nvar scripts = [\n    { code: setupHistoryListeners.toString(), id: \"historyListener\" },\n    {\n        code: \"function consoleHook({ scope }) {\" + consoleHook + \"\\n};\",\n        id: \"consoleHook\",\n    },\n    { code: watchResize.toString(), id: \"watchResize\" },\n];\nvar injectScriptToIframe = function (iframe, channelId) {\n    scripts.forEach(function (_a) {\n        var _b;\n        var code = _a.code, id = _a.id;\n        var message = {\n            uid: id,\n            type: INJECT_MESSAGE_TYPE,\n            code: \"exports.activate = \".concat(code),\n            scope: { channelId: channelId },\n        };\n        (_b = iframe.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage(message, \"*\");\n    });\n};\n\n/* eslint-disable no-console,@typescript-eslint/no-explicit-any,prefer-rest-params,@typescript-eslint/explicit-module-boundary-types */\nvar SandpackNode = /** @class */ (function (_super) {\n    __extends(SandpackNode, _super);\n    function SandpackNode(selector, sandboxInfo, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, selector, sandboxInfo, __assign(__assign({}, options), { bundlerURL: options.bundlerURL })) || this;\n        _this._modulesCache = new Map();\n        _this.messageChannelId = generateRandomId();\n        _this._initPromise = null;\n        _this.emitter = new EventEmitter();\n        // Assign iframes\n        _this.manageIframes(selector);\n        // Init emulator\n        _this.emulator = new Nodebox({\n            iframe: _this.emulatorIframe,\n            runtimeUrl: _this.options.bundlerURL,\n        });\n        // Trigger initial compile\n        _this.updateSandbox(sandboxInfo);\n        return _this;\n    }\n    // Initialize nodebox, should only ever be called once\n    SandpackNode.prototype._init = function (files) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.emulator.connect()];\n                    case 1:\n                        _a.sent();\n                        // 2. Setup\n                        return [4 /*yield*/, this.emulator.fs.init(files)];\n                    case 2:\n                        // 2. Setup\n                        _a.sent();\n                        // 2.1 Other dependencies\n                        return [4 /*yield*/, this.globalListeners()];\n                    case 3:\n                        // 2.1 Other dependencies\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * It initializes the emulator and provide it with files, template and script to run\n     */\n    SandpackNode.prototype.compile = function (files) {\n        return __awaiter(this, void 0, void 0, function () {\n            var shellId, err_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        // 1. Init\n                        this.status = \"initializing\";\n                        this.dispatch({ type: \"start\", firstLoad: true });\n                        if (!this._initPromise) {\n                            this._initPromise = this._init(files);\n                        }\n                        return [4 /*yield*/, this._initPromise];\n                    case 1:\n                        _a.sent();\n                        this.dispatch({ type: \"connected\" });\n                        return [4 /*yield*/, this.createShellProcessFromTask(files)];\n                    case 2:\n                        shellId = (_a.sent()).id;\n                        // 4. Launch Preview\n                        return [4 /*yield*/, this.createPreviewURLFromId(shellId)];\n                    case 3:\n                        // 4. Launch Preview\n                        _a.sent();\n                        return [4 /*yield*/, this.setLocationURLIntoIFrame()];\n                    case 4:\n                        _a.sent();\n                        // 5. Returns to consumer\n                        this.dispatchDoneMessage();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _a.sent();\n                        this.dispatch({\n                            type: \"action\",\n                            action: \"notification\",\n                            notificationType: \"error\",\n                            title: getMessageFromError(err_1),\n                        });\n                        this.dispatch({ type: \"done\", compilatonError: true });\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * It creates a new shell and run the starting task\n     */\n    SandpackNode.prototype.createShellProcessFromTask = function (files) {\n        return __awaiter(this, void 0, void 0, function () {\n            var packageJsonContent;\n            var _a;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        packageJsonContent = readBuffer(files[\"/package.json\"]);\n                        this.emulatorCommand = findStartScriptPackageJson(packageJsonContent);\n                        this.emulatorShellProcess = this.emulator.shell.create();\n                        // Shell listeners\n                        return [4 /*yield*/, this.emulatorShellProcess.on(\"exit\", function (exitCode) {\n                                _this.dispatch({\n                                    type: \"action\",\n                                    action: \"notification\",\n                                    notificationType: \"error\",\n                                    title: createError(\"Error: process.exit(\".concat(exitCode, \") called.\")),\n                                });\n                            })];\n                    case 1:\n                        // Shell listeners\n                        _b.sent();\n                        return [4 /*yield*/, this.emulatorShellProcess.on(\"progress\", function (data) {\n                                var _a, _b;\n                                if (data.state === \"command_running\" ||\n                                    data.state === \"starting_command\") {\n                                    _this.dispatch({\n                                        type: \"shell/progress\",\n                                        data: __assign(__assign({}, data), { command: [\n                                                (_a = _this.emulatorCommand) === null || _a === void 0 ? void 0 : _a[0],\n                                                (_b = _this.emulatorCommand) === null || _b === void 0 ? void 0 : _b[1].join(\" \"),\n                                            ].join(\" \") }),\n                                    });\n                                    _this.status = \"installing-dependencies\";\n                                    return;\n                                }\n                                _this.dispatch({ type: \"shell/progress\", data: data });\n                            })];\n                    case 2:\n                        _b.sent();\n                        this.emulatorShellProcess.stdout.on(\"data\", function (data) {\n                            _this.dispatch({ type: \"stdout\", payload: { data: data, type: \"out\" } });\n                        });\n                        this.emulatorShellProcess.stderr.on(\"data\", function (data) {\n                            _this.dispatch({ type: \"stdout\", payload: { data: data, type: \"err\" } });\n                        });\n                        return [4 /*yield*/, (_a = this.emulatorShellProcess).runCommand.apply(_a, this.emulatorCommand)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.createPreviewURLFromId = function (id) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var url;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.iframePreviewUrl = undefined;\n                        return [4 /*yield*/, this.emulator.preview.getByShellId(id)];\n                    case 1:\n                        url = (_b.sent()).url;\n                        this.iframePreviewUrl = url + ((_a = this.options.startRoute) !== null && _a !== void 0 ? _a : \"\");\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Nodebox needs to handle two types of iframes at the same time:\n     *\n     * 1. Runtime iframe: where the emulator process runs, which is responsible\n     *    for creating the other iframes (hidden);\n     * 2. Preview iframes: any other node process that contains a PORT (public);\n     */\n    SandpackNode.prototype.manageIframes = function (selector) {\n        var _a;\n        /**\n         * Pick the preview iframe\n         */\n        if (typeof selector === \"string\") {\n            var element = document.querySelector(selector);\n            nullthrows(element, \"The element '\".concat(selector, \"' was not found\"));\n            this.iframe = document.createElement(\"iframe\");\n        }\n        else {\n            this.iframe = selector;\n        }\n        // Set preview iframe styles\n        setPreviewIframeProperties(this.iframe, this.options);\n        nullthrows(this.iframe.parentNode, \"The given iframe does not have a parent.\");\n        /**\n         * Create the runtime iframe, which is hidden sibling\n         * from the preview one\n         */\n        this.emulatorIframe = document.createElement(\"iframe\");\n        this.emulatorIframe.classList.add(\"sp-bridge-frame\");\n        (_a = this.iframe.parentNode) === null || _a === void 0 ? void 0 : _a.appendChild(this.emulatorIframe);\n    };\n    SandpackNode.prototype.setLocationURLIntoIFrame = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.iframePreviewUrl) return [3 /*break*/, 2];\n                        return [4 /*yield*/, loadPreviewIframe(this.iframe, this.iframePreviewUrl)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Send all messages and events to tell to the\n     * consumer that the bundler is ready without any error\n     */\n    SandpackNode.prototype.dispatchDoneMessage = function () {\n        this.status = \"done\";\n        this.dispatch({ type: \"done\", compilatonError: false });\n        if (this.iframePreviewUrl) {\n            this.dispatch({\n                type: \"urlchange\",\n                url: this.iframePreviewUrl,\n                back: false,\n                forward: false,\n            });\n        }\n    };\n    SandpackNode.prototype.globalListeners = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        window.addEventListener(\"message\", function (event) {\n                            if (event.data.type === PREVIEW_LOADED_MESSAGE_TYPE) {\n                                injectScriptToIframe(_this.iframe, _this.messageChannelId);\n                            }\n                            if (event.data.type === \"urlchange\" &&\n                                event.data.channelId === _this.messageChannelId) {\n                                _this.dispatch({\n                                    type: \"urlchange\",\n                                    url: event.data.url,\n                                    back: event.data.back,\n                                    forward: event.data.forward,\n                                });\n                            }\n                            else if (event.data.channelId === _this.messageChannelId) {\n                                _this.dispatch(event.data);\n                            }\n                        });\n                        return [4 /*yield*/, this.emulator.fs.watch([\"*\"], [\n                                \".next\",\n                                \"node_modules\",\n                                \"build\",\n                                \"dist\",\n                                \"vendor\",\n                                \".config\",\n                                \".vuepress\",\n                            ], function (message) { return __awaiter(_this, void 0, void 0, function () {\n                                var event, path, type, _a, content, newContent, err_2;\n                                return __generator(this, function (_b) {\n                                    switch (_b.label) {\n                                        case 0:\n                                            if (!message)\n                                                return [2 /*return*/];\n                                            event = message;\n                                            path = \"newPath\" in event\n                                                ? event.newPath\n                                                : \"path\" in event\n                                                    ? event.path\n                                                    : \"\";\n                                            return [4 /*yield*/, this.emulator.fs.stat(path)];\n                                        case 1:\n                                            type = (_b.sent()).type;\n                                            if (type !== \"file\")\n                                                return [2 /*return*/, null];\n                                            _b.label = 2;\n                                        case 2:\n                                            _b.trys.push([2, 10, , 11]);\n                                            _a = event.type;\n                                            switch (_a) {\n                                                case \"change\": return [3 /*break*/, 3];\n                                                case \"create\": return [3 /*break*/, 3];\n                                                case \"remove\": return [3 /*break*/, 5];\n                                                case \"rename\": return [3 /*break*/, 6];\n                                                case \"close\": return [3 /*break*/, 8];\n                                            }\n                                            return [3 /*break*/, 9];\n                                        case 3: return [4 /*yield*/, this.emulator.fs.readFile(event.path, \"utf8\")];\n                                        case 4:\n                                            content = _b.sent();\n                                            this.dispatch({\n                                                type: \"fs/change\",\n                                                path: event.path,\n                                                content: content,\n                                            });\n                                            this._modulesCache.set(event.path, writeBuffer(content));\n                                            return [3 /*break*/, 9];\n                                        case 5:\n                                            this.dispatch({\n                                                type: \"fs/remove\",\n                                                path: event.path,\n                                            });\n                                            this._modulesCache.delete(event.path);\n                                            return [3 /*break*/, 9];\n                                        case 6:\n                                            this.dispatch({\n                                                type: \"fs/remove\",\n                                                path: event.oldPath,\n                                            });\n                                            this._modulesCache.delete(event.oldPath);\n                                            return [4 /*yield*/, this.emulator.fs.readFile(event.newPath, \"utf8\")];\n                                        case 7:\n                                            newContent = _b.sent();\n                                            this.dispatch({\n                                                type: \"fs/change\",\n                                                path: event.newPath,\n                                                content: newContent,\n                                            });\n                                            this._modulesCache.set(event.newPath, writeBuffer(newContent));\n                                            return [3 /*break*/, 9];\n                                        case 8: return [3 /*break*/, 9];\n                                        case 9: return [3 /*break*/, 11];\n                                        case 10:\n                                            err_2 = _b.sent();\n                                            this.dispatch({\n                                                type: \"action\",\n                                                action: \"notification\",\n                                                notificationType: \"error\",\n                                                title: getMessageFromError(err_2),\n                                            });\n                                            return [3 /*break*/, 11];\n                                        case 11: return [2 /*return*/];\n                                    }\n                                });\n                            }); })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * PUBLIC Methods\n     */\n    SandpackNode.prototype.restartShellProcess = function () {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!(this.emulatorShellProcess && this.emulatorCommand)) return [3 /*break*/, 3];\n                        // 1. Set the loading state and clean the URL\n                        this.dispatch({ type: \"start\", firstLoad: true });\n                        this.status = \"initializing\";\n                        // 2. Exit shell\n                        return [4 /*yield*/, this.emulatorShellProcess.kill()];\n                    case 1:\n                        // 2. Exit shell\n                        _b.sent();\n                        (_a = this.iframe) === null || _a === void 0 ? void 0 : _a.removeAttribute(\"attr\");\n                        this.emulator.fs.rm(\"/node_modules/.vite\", {\n                            recursive: true,\n                            force: true,\n                        });\n                        // 3 Run command again\n                        return [4 /*yield*/, this.compile(Object.fromEntries(this._modulesCache))];\n                    case 2:\n                        // 3 Run command again\n                        _b.sent();\n                        _b.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.updateSandbox = function (setup) {\n        var _this = this;\n        var _a;\n        var modules = fromBundlerFilesToFS(setup.files);\n        /**\n         * Update file changes\n         */\n        if (((_a = this.emulatorShellProcess) === null || _a === void 0 ? void 0 : _a.state) === \"running\") {\n            Object.entries(modules).forEach(function (_a) {\n                var key = _a[0], value = _a[1];\n                if (!_this._modulesCache.get(key) ||\n                    readBuffer(value) !== readBuffer(_this._modulesCache.get(key))) {\n                    _this.emulator.fs.writeFile(key, value, { recursive: true });\n                }\n            });\n            return;\n        }\n        /**\n         * Pass init files to the bundler\n         */\n        this.dispatch({\n            codesandbox: true,\n            modules: modules,\n            template: setup.template,\n            type: \"compile\",\n        });\n        /**\n         * Add modules to cache, this will ensure uniqueness changes\n         *\n         * Keep it after the compile action, in order to update the cache at the right moment\n         */\n        Object.entries(modules).forEach(function (_a) {\n            var key = _a[0], value = _a[1];\n            _this._modulesCache.set(key, writeBuffer(value));\n        });\n    };\n    SandpackNode.prototype.dispatch = function (message) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var _c;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _c = message.type;\n                        switch (_c) {\n                            case \"compile\": return [3 /*break*/, 1];\n                            case \"refresh\": return [3 /*break*/, 2];\n                            case \"urlback\": return [3 /*break*/, 4];\n                            case \"urlforward\": return [3 /*break*/, 4];\n                            case \"shell/restart\": return [3 /*break*/, 5];\n                            case \"shell/openPreview\": return [3 /*break*/, 6];\n                        }\n                        return [3 /*break*/, 7];\n                    case 1:\n                        this.compile(message.modules);\n                        return [3 /*break*/, 8];\n                    case 2: return [4 /*yield*/, this.setLocationURLIntoIFrame()];\n                    case 3:\n                        _d.sent();\n                        return [3 /*break*/, 8];\n                    case 4:\n                        (_b = (_a = this.iframe) === null || _a === void 0 ? void 0 : _a.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage(message, \"*\");\n                        return [3 /*break*/, 8];\n                    case 5:\n                        this.restartShellProcess();\n                        return [3 /*break*/, 8];\n                    case 6:\n                        window.open(this.iframePreviewUrl, \"_blank\");\n                        return [3 /*break*/, 8];\n                    case 7:\n                        this.emitter.dispatch(message);\n                        _d.label = 8;\n                    case 8: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.listen = function (listener) {\n        return this.emitter.listener(listener);\n    };\n    SandpackNode.prototype.destroy = function () {\n        this.emulatorIframe.remove();\n        this.emitter.cleanup();\n    };\n    return SandpackNode;\n}(SandpackClient));\n\nexport { SandpackNode };\n"],"names":["__create","__defProp","__getOwnPropDesc","__getOwnPropNames","__getProtoOf","__hasOwnProp","__defNormalProp","obj","key","value","__commonJS","cb","mod","__copyProps","to","from","except","desc","__toESM","isNodeMode","target","__publicField","__accessCheck","member","msg","__privateGet","getter","__privateAdd","__privateSet","setter","__privateMethod","method","require_pad","exports","module","num","size","s","require_fingerprint_browser","pad","env","globalCount","mimeTypesLength","clientId","require_getRandomValue_browser","getRandomValue","crypto","lim","require_cuid","fingerprint","c","blockSize","base","discreteValues","randomBlock","safeCounter","cuid3","letter","timestamp","counter","print","random","date","stringToCheck","stringLength","require_createDeferredExecutor","createDeferredExecutor","executor","resolve","reject","data","onFulfilled","reason","require_DeferredPromise","createDeferredExecutor_1","DeferredPromise4","_a","deferredExecutor","originalResolve","originalReject","_decorate","_executor","onRejected","decorate_fn","onfinally","promise","require_build","__createBinding","o","m","k","k2","__exportStar","exports2","p","require_MemoryLeakError","MemoryLeakError","emitter","type","count","require_Emitter","MemoryLeakError_1","_events","_maxListeners","_hasWarnedAboutPotentialMemortyLeak","_getListeners","getListeners_fn","_removeListener","removeListener_fn","_wrapOnceListener","wrapOnceListener_fn","_internalEmit","internalEmit_fn","_Emitter","eventName","maxListeners","listeners","listener","nextListeners","memoryLeakWarning","Emitter2","index","onceListener","internalEventName","require_lib","import_cuid","POSITIONALS_EXP","serializePositional","positional","flag","json","format","message","positionals","positionalIndex","formattedMessage","match","isEscaped","_","STACK_FRAMES_TO_IGNORE","cleanErrorStack","error","nextStack","InvariantError","invariant","predicate","ErrorConstructor","import_deferred_promise","FLAG","DEFAULT","GREEN","RED","BLUE","YELLOW","MAGENTA","CYAN","COLOR_SCOPE","createDebug","scope","direction","cleanMessage","debug","MessageSender","receiverReadyPromise","handshakeListener","evt","handshakePromise","rejectionTimeout","event","options","operationPromise","operationId","payload","handleOperationDone","doneEvent","data2","listenerPayload","handleOperationFailed","failEvent","import_deferred_promise3","import_cuid2","FileSystemApi","channel","files","path","encoding","response","content","recursive","force","includes","excludes","watcherId","import_strict_event_emitter","ShellApi","ShellProcess","command","args","shellInfo","import_deferred_promise2","TIMEOUT","PreviewApi","timeout","readyPromise","rejectTimeout","previewInformation","foundPreview","sourceShellId","port","DEFAULT_RUNTIME_URL","debug2","Nodebox","iframe","cdnUrl","connectionPromise","frameLoadPromise","INJECT_MESSAGE_TYPE","PREVIEW_LOADED_MESSAGE_TYPE","loadPreviewIframe","url","__awaiter","contentWindow","TIME_OUT","MAX_MANY_TIRES","tries","__generator","nullthrows","triesToSetUrl","onLoadPage","createError","setPreviewIframeProperties","setupHistoryListeners","origHistoryProto","historyList","historyPosition","dispatchMessage","pushHistory","state","delta","newPos","newURL","title","handleMessage","watchResize","lastHeight","getDocumentHeight","body","html","sendResizeEvent","height","throttle","observer","scripts","consoleHook","injectScriptToIframe","channelId","_b","code","id","SandpackNode","_super","__extends","selector","sandboxInfo","_this","__assign","generateRandomId","EventEmitter","shellId","err_1","getMessageFromError","packageJsonContent","readBuffer","findStartScriptPackageJson","exitCode","element","newContent","err_2","writeBuffer","setup","modules","fromBundlerFilesToFS","_c","_d","SandpackClient"],"mappings":"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"}